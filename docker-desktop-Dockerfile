FROM ubuntu:24.04

# Avoid prompts during installation
ENV DEBIAN_FRONTEND=noninteractive

# Install Xfce, TigerVNC, and basic tools
RUN apt-get update && apt-get install -y xfce4 xfce4-goodies tigervnc-standalone-server dbus-x11 x11-xserver-utils sudo curl && apt-get clean && rm -rf /var/lib/apt/lists/*

# Copy in the startup scripts. Further setup is done after startup by these scripts rather than here as we create a separate named user in each container instance and need to
# match up UIDs with the host, which we don't know until container creation time.
COPY per-user-web-server/docker-desktop-xstartup /root/docker-desktop-xstartup
COPY per-user-web-server/docker-desktop-root-startup.sh /root/docker-desktop-root-startup.sh
COPY per-user-web-server/docker-desktop-user-startup.sh /root/docker-desktop-user-startup.sh
